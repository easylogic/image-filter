!function(t,n){"object"==typeof exports&&"object"==typeof module?module.exports=n(require("@easylogic/color")):"function"==typeof define&&define.amd?define(["@easylogic/color"],n):"object"==typeof exports?exports.EasyLogicImageFilter=n(require("@easylogic/color")):t.EasyLogicImageFilter=n(t["@easylogic/color"])}(self,(function(t){return(()=>{"use strict";var n={984:n=>{n.exports=t}},r={};function e(t){var i=r[t];if(void 0!==i)return i.exports;var a=r[t]={exports:{}};return n[t](a,a.exports,e),a.exports}e.n=t=>{var n=t&&t.__esModule?()=>t.default:()=>t;return e.d(n,{a:n}),n},e.d=(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},e.o=(t,n)=>Object.prototype.hasOwnProperty.call(t,n);var i={};return(()=>{e.d(i,{default:()=>Wt});var t=e(984),n=e.n(t);const r={create:function(t,n){var r=document.createElement("canvas");return r.width=t||0,r.height=n||0,r},drawPixels:function(t){var n=this.create(t.width,t.height),r=n.getContext("2d"),e=r.getImageData(0,0,n.width,n.height);return e.data.set(t.pixels),r.putImageData(e,0,0),n},createHistogram:function(t,n,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{black:!0,red:!1,green:!1,blue:!1},a=this.create(t,n),o=a.getContext("2d");o.clearRect(0,0,t,n),o.fillStyle="white",o.fillRect(0,0,t,n),o.globalAlpha=.7;var c={black:!1};i.black?c.black=!1:c.black=!0,i.red?c.red=!1:c.red=!0,i.green?c.green=!1:c.green=!0,i.blue?c.blue=!1:c.blue=!0,Object.keys(r).forEach((function(e){if(!c[e]){var i=r[e],a=Math.max.apply(Math,i),u=t/i.length;o.fillStyle=e,i.forEach((function(t,r){var e=n*(t/a),i=r*u;o.fillRect(i,n-e,u,e)}))}})),"function"==typeof e&&e(a)},getHistogram:function(t){for(var r=new Array(256),e=new Array(256),i=new Array(256),a=new Array(256),o=0;o<256;o++)r[o]=0,e[o]=0,i[o]=0,a[o]=0;return function(t,o){!function(t,n){for(var r=0;r<t;r+=4)n(r)}(t.pixels.length,(function(o){!function(t,o){var c=Math.round(n().brightness(t[o],t[o+1],t[o+2]));r[c]++,e[t[o]]++,i[t[o+1]]++,a[t[o+2]]++}(t.pixels,o)}))}(t),{black:r,red:e,green:i,blue:a}},getBitmap:function(t,n){var r=this.drawPixels(t);return{pixels:r.getContext("2d").getImageData(n.x||0,n.y||0,n.width||r.width,n.height||r.height).data,width:n.width,height:n.height}},putBitmap:function(t,n,r){var e=this.drawPixels(t),i=this.drawPixels(n),a=e.getContext("2d");return a.drawImage(i,r.x,r.y),t.pixels=a.getImageData(0,0,t.width,t.height).data,t}};var a={identity:function(){return[1,0,0,0,1,0,0,0,1]},stretching:function(t){return[t,0,0,0,1,0,0,0,1]},squeezing:function(t){return[t,0,0,0,1/t,0,0,0,1]},scale:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return[t=t||0===t?t:1,0,0,0,n=n||0===n?n:1,0,0,0,1]},scaleX:function(t){return this.scale(t)},scaleY:function(t){return this.scale(1,t)},translate:function(t,n){return[1,0,t,0,1,n,0,0,1]},rotate:function(t){var n=this.radian(t);return[Math.cos(n),-Math.sin(n),0,Math.sin(n),Math.cos(n),0,0,0,1]},rotate90:function(){return[0,-1,0,1,0,0,0,0,1]},rotate180:function(){return[-1,0,0,0,-1,0,0,0,1]},rotate270:function(){return[0,1,0,-1,0,0,0,0,1]},radian:function(t){return t*Math.PI/180},skew:function(t,n){var r=this.radian(t),e=this.radian(n);return[1,Math.tan(r),0,Math.tan(e),1,0,0,0,1]},skewX:function(t){var n=this.radian(t);return[1,Math.tan(n),0,0,1,0,0,0,1]},skewY:function(t){var n=this.radian(t);return[1,0,0,Math.tan(n),1,0,0,0,1]},shear1:function(t){return[1,-Math.tan(this.radian(t)/2),0,0,1,0,0,0,1]},shear2:function(t){return[1,0,0,Math.sin(this.radian(t)),1,0,0,0,1]}};const o={CONSTANT:a,radian:function(t){return a.radian(t)},multiply:function(t,n){return[t[0]*n[0]+t[1]*n[1]+t[2]*n[2],t[3]*n[0]+t[4]*n[1]+t[5]*n[2],t[6]*n[0]+t[7]*n[1]+t[8]*n[2]]},identity:function(t){return this.multiply(a.identity(),t)},translate:function(t,n,r){return this.multiply(a.translate(t,n),r)},rotate:function(t,n){return this.multiply(a.rotate(t),n)},shear1:function(t,n){return this.multiply(a.shear1(t),n)},shear2:function(t,n){return this.multiply(a.shear2(t),n)},rotateShear:function(t,n){var r=n;return r=this.shear1(t,r),r=this.shear2(t,r),this.shear1(t,r)}};function c(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var r=t&&("undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"]);if(null!=r){var e,i,a=[],o=!0,c=!1;try{for(r=r.call(t);!(o=(e=r.next()).done)&&(a.push(e.value),!n||a.length!==n);o=!0);}catch(t){c=!0,i=t}finally{try{o||null==r.return||r.return()}finally{if(c)throw i}}return a}}(t,n)||function(t,n){if(t){if("string"==typeof t)return u(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(t,n):void 0}}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,e=new Array(n);r<n;r++)e[r]=t[r];return e}function l(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"center",r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"center";return function(e,i){var a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},u=X(e.pixels.length,e.width,e.height),l=e.width,h=e.height;"center"==n&&(n=Math.floor(l/2)),"center"==r&&(r=Math.floor(h/2));var $=o.CONSTANT.translate(-n,-r),f=o.CONSTANT.translate(n,r),s=o.CONSTANT.shear1(t),g=o.CONSTANT.shear2(t);ut((function(t,n,r,i){var a=o.multiply($,[r,i,1]);a=o.multiply(s,a).map(Math.round),a=o.multiply(g,a).map(Math.round),a=o.multiply(s,a).map(Math.round);var u=c(a=o.multiply(f,a),2),v=u[0],p=u[1];v<0||p<0||v>l-1||p>h-1||$t(t,p*l+v<<2,e.pixels,n)}))(u,(function(){i(u)}),a)}}function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100,r=!(arguments.length>2&&void 0!==arguments[2])||arguments[2],e=tt(t),i=(n=tt(n))/100,a=r;return at("\n        // refer to Color.brightness \n        const v = ($C * Math.ceil($r * 0.2126 + $g * 0.7152 + $b * 0.0722) ) >= $scale ? 255 : 0;\n\n        if ($hasColor) {\n\n            if (v == 0) {\n                $r = 0; \n                $g = 0; \n                $b = 0;\n            }\n            \n        } else {\n            const value = Math.round(v);\n            $r = value; \n            $g = value;\n            $b = value; \n        }\n        \n    ",{$C:i,$scale:e,$hasColor:a})}const $={bitonal:function(t,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:100,i=n().parse(t),a=n().parse(r),o=e;return at("        \n        const thresholdColor = ( $r + $g + $b ) <= $threshold ? $darkColor : $lightColor\n\n        $r = thresholdColor.r;\n        $g = thresholdColor.g;\n        $b = thresholdColor.b; \n    ",{$threshold:o},{$darkColor:i,$lightColor:a})},brightness:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;t=tt(t);var n=Math.floor(t/100*255);return at("\n        $r += $C;\n        $g += $C;\n        $b += $C;\n    ",{$C:n})},brownie:function(){return at("\n        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;\n        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;\n        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;\n        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;        \n    ",{$matrix:[.5997023498159715,.34553243048391263,-.2708298674538042,0,-.037703249837783157,.8609577587992641,.15059552388459913,0,.24113635128153335,-.07441037908422492,.44972182064877153,0,0,0,0,1]})},clip:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t=tt(t);var n=2.55*Math.abs(t);return at("\n\n        $r = ($r > 255 - $C) ? 255 : 0;\n        $g = ($g > 255 - $C) ? 255 : 0;\n        $b = ($b > 255 - $C) ? 255 : 0;\n\n    ",{$C:n})},contrast:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;t=tt(t);var n=Math.max((128+t)/128,0);return at("\n        $r *= $C;\n        $g *= $C;\n        $b *= $C;\n    ",{$C:n})},gamma:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=tt(t);return at("\n        $r = Math.pow($r / 255, $C) * 255;\n        $g = Math.pow($g / 255, $C) * 255;\n        $b = Math.pow($b / 255, $C) * 255;\n    ",{$C:n})},gradient:function(){var t=Array.prototype.slice.call(arguments);1===t.length&&"string"==typeof t[0]&&(t=n().convertMatchesArray(t[0]));var r=(t=t.map((function(t){return n().matches(t).length?{type:"param",value:t}:{type:"scale",value:t}}))).filter((function(t){return"scale"==t.type}))[0];r=r?+r.value:256,t=t.filter((function(t){return"param"==t.type})).map((function(t){return t.value})).join(",");var e=n().gradient(t,r).map((function(t){var r=n().parse(t);return{r:r.r,g:r.g,b:r.b,a:r.a}}));return at("\n        const colorIndex = clamp(Math.ceil($r * 0.2126 + $g * 0.7152 + $b * 0.0722));\n        const newColorIndex = clamp(Math.floor(colorIndex * ($scale / 256)));\n        const color = $colors[newColorIndex];\n\n        $r = color.r; \n        $g = color.g; \n        $b = color.b; \n        $a = clamp(Math.floor(color.a * 256));\n    ",{},{$colors:e,$scale:r})},grayscale:function(t){var n=(t=tt(t))/100;return n>1&&(n=1),at("\n        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;\n        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;\n        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;\n        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;\n    ",{$matrix:[.2126+.7874*(1-n),.7152-.7152*(1-n),.0722-.0722*(1-n),0,.2126-.2126*(1-n),.7152+.2848*(1-n),.0722-.0722*(1-n),0,.2126-.2126*(1-n),.7152-.7152*(1-n),.0722+.9278*(1-n),0,0,0,0,1]})},hue:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:360,n=tt(t);return at("\n        var hsv = Color.RGBtoHSV($r, $g, $b);\n\n        // 0 ~ 360 \n        var h = hsv.h;\n        h += Math.abs($C);\n        h = h % 360;\n        hsv.h = h;\n\n        var rgb = Color.HSVtoRGB(hsv);\n\n        $r = rgb.r;\n        $g = rgb.g;\n        $b = rgb.b;\n    ",{$C:n})},invert:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=(t=tt(t))/100;return at("\n        $r = (255 - $r) * $C;\n        $g = (255 - $g) * $C;\n        $b = (255 - $b) * $C;\n    ",{$C:n})},kodachrome:function(){return at("\n        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;\n        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;\n        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;\n        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;\n    ",{$matrix:[1.1285582396593525,-.3967382283601348,-.03992559172921793,0,-.16404339962244616,1.0835251566291304,-.05498805115633132,0,-.16786010706155763,-.5603416277695248,1.6014850761964943,0,0,0,0,1]})},matrix:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:0,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:0,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:0,c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:0,l=arguments.length>9&&void 0!==arguments[9]?arguments[9]:0,h=arguments.length>10&&void 0!==arguments[10]?arguments[10]:0,$=arguments.length>11&&void 0!==arguments[11]?arguments[11]:0,f=arguments.length>12&&void 0!==arguments[12]?arguments[12]:0,s=arguments.length>13&&void 0!==arguments[13]?arguments[13]:0,g=arguments.length>14&&void 0!==arguments[14]?arguments[14]:0,v=arguments.length>15&&void 0!==arguments[15]?arguments[15]:0,p=[t,n,r,e,i,a,o,c,u,l,h,$,f,s,g,v];return at("\n        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;\n        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;\n        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;\n        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;\n    ",{$matrix:p})},noise:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=tt(t);return at("\n        const C = Math.abs($C) * 5;\n        const min = -C;\n        const max = C;\n        const noiseValue = Math.round(min + (Math.random() * (max - min)));\n\n        $r += noiseValue;\n        $g += noiseValue;\n        $b += noiseValue;\n    ",{$C:n})},opacity:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=(t=tt(t))/100;return at("\n        $a *= $C; \n    ",{$C:n})},polaroid:function(){return at("\n        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;\n        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;\n        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;\n        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;\n    ",{$matrix:[1.438,-.062,-.062,0,-.122,1.378,-.122,0,-.016,-.016,1.483,0,0,0,0,1]})},saturation:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=(t=tt(t))/100,r=1-Math.abs(n),e=[r,0,0,0,0,r,0,0,0,0,r,0,0,0,0,r];return at("\n        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;\n        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;\n        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;\n        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;        \n    ",{$matrix:e})},sepia:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=tt(t);n>1&&(n=1);var r=[.393+.607*(1-n),.769-.769*(1-n),.189-.189*(1-n),0,.349-.349*(1-n),.686+.314*(1-n),.168-.168*(1-n),0,.272-.272*(1-n),.534-.534*(1-n),.131+.869*(1-n),0,0,0,0,1];return at("\n        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;\n        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;\n        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;\n        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;        \n    ",{$matrix:r})},shade:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,e=tt(t),i=tt(n),a=tt(r);return at("\n        $r *= $redValue;\n        $g *= $greenValue;\n        $b *= $blueValue;\n    ",{$redValue:e,$greenValue:i,$blueValue:a})},shift:function(){return at("\n        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;\n        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;\n        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;\n        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;        \n    ",{$matrix:[1.438,-.062,-.062,0,-.122,1.378,-.122,0,-.016,-.016,1.483,0,0,0,0,1]})},solarize:function(t,n,r){return at("\n        $r = ($r < $redValue) ? 255 - $r: $r;\n        $g = ($g < $greenValue) ? 255 - $g: $g;\n        $b = ($b < $blueValue) ? 255 - $b: $b;\n    ",{$redValue:tt(t),$greenValue:tt(n),$blueValue:tt(r)})},technicolor:function(){return at("\n        $r = $matrix[0] * $r + $matrix[1] * $g + $matrix[2] * $b + $matrix[3] * $a;\n        $g = $matrix[4] * $r + $matrix[5] * $g + $matrix[6] * $b + $matrix[7] * $a;\n        $b = $matrix[8] * $r + $matrix[9] * $g + $matrix[10] * $b + $matrix[11] * $a;\n        $a = $matrix[12] * $r + $matrix[13] * $g + $matrix[14] * $b + $matrix[15] * $a;\n    ",{$matrix:[1.9125277891456083,-.8545344976951645,-.09155508482755585,0,-.3087833385928097,1.7658908555458428,-.10601743074722245,0,-.231103377548616,-.7501899197440212,1.847597816108189,0,0,0,0,1]})},threshold:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:200,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;return h(t,n,!1)},"threshold-color":h,tint:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,e=tt(t),i=tt(n),a=tt(r);return at("\n\n        $r += (255 - $r) * $redTint;\n        $g += (255 - $g) * $greenTint;\n        $b += (255 - $b) * $blueTint;\n\n    ",{$redTint:e,$greenTint:i,$blueTint:a})}};function f(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=(t=tt(t))/100;return gt(L([1,2,1,2,4,2,1,2,1],1/16*n))}function s(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100,n=(t=tt(t))/100;return gt(L([1,4,6,4,1,4,16,24,16,4,6,24,36,24,6,4,16,24,16,4,1,4,6,4,1],1/256*n))}function g(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return t=tt(t),gt([5,5,5,-3,0,-3,-3,-3,-3])}function v(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return t=tt(t),gt([5,-3,-3,5,0,-3,5,-3,-3])}function p(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return gt(L([-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,24,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1],(t=tt(t))/100))}function m(){return gt(L([1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1],1/9))}function d(){return gt(L([1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,1,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,0,1,0,1,0,0,0,0,0,0,0,1],1/9))}function x(){return gt(L([1,0,0,0,1,0,0,0,1,0,1,0,0,1,0,0,1,0,0,0,1,0,1,0,1,0,0,0,0,0,1,1,1,0,0,0,1,1,1,1,1,1,1,1,1,0,0,0,1,1,1,0,0,0,0,0,1,0,1,0,1,0,0,0,1,0,0,1,0,0,1,0,1,0,0,0,1,0,0,0,1],1/9))}function b(){return gt([-1,-2,-1,0,0,0,1,2,1])}function y(){return gt([-1,0,1,-2,0,2,-1,0,1])}var w=[512,512,456,512,328,456,335,512,405,328,271,456,388,335,292,512,454,405,364,328,298,271,496,456,420,388,360,335,312,292,273,512,482,454,428,405,383,364,345,328,312,298,284,271,259,496,475,456,437,420,404,388,374,360,347,335,323,312,302,292,282,273,265,512,497,482,468,454,441,428,417,405,394,383,373,364,354,345,337,328,320,312,305,298,291,284,278,271,265,259,507,496,485,475,465,456,446,437,428,420,412,404,396,388,381,374,367,360,354,347,341,335,329,323,318,312,307,302,297,292,287,282,278,273,269,265,261,512,505,497,489,482,475,468,461,454,447,441,435,428,422,417,411,405,399,394,389,383,378,373,368,364,359,354,350,345,341,337,332,328,324,320,316,312,309,305,301,298,294,291,287,284,281,278,274,271,268,265,262,259,257,507,501,496,491,485,480,475,470,465,460,456,451,446,442,437,433,428,424,420,416,412,408,404,400,396,392,388,385,381,377,374,370,367,363,360,357,354,350,347,344,341,338,335,332,329,326,323,320,318,315,312,310,307,304,302,299,297,294,292,289,287,285,282,280,278,275,273,271,269,267,265,263,261,259],C=[9,11,12,13,13,14,14,15,15,15,15,16,16,16,16,17,17,17,17,17,17,17,18,18,18,18,18,18,18,18,18,19,19,19,19,19,19,19,19,19,19,19,19,19,19,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,20,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,21,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,22,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,23,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24,24];function O(){this.r=0,this.g=0,this.b=0,this.a=0,this.next=null}const j=function(t,n,r){return r?function(t,n,r,e){if(isNaN(e)||e<1)return t;e|=0;var i,a,o,c,u,l,h,$,f,s,g,v,p,m,d,x,b,y,j,M,I,A,k,P,S=t.pixels,E=t.width,T=t.height,D=e+e+1,R=E-1,B=T-1,V=e+1,U=V*(V+1)/2,N=new O,F=N;for(o=1;o<D;o++)if(F=F.next=new O,o==V)var H=F;F.next=N;var L=null,q=null;h=l=0;var z=w[e],G=C[e];for(a=0;a<T;a++){for(x=b=y=j=$=f=s=g=0,v=V*(M=S[l]),p=V*(I=S[l+1]),m=V*(A=S[l+2]),d=V*(k=S[l+3]),$+=U*M,f+=U*I,s+=U*A,g+=U*k,F=N,o=0;o<V;o++)F.r=M,F.g=I,F.b=A,F.a=k,F=F.next;for(o=1;o<V;o++)c=l+((R<o?R:o)<<2),$+=(F.r=M=S[c])*(P=V-o),f+=(F.g=I=S[c+1])*P,s+=(F.b=A=S[c+2])*P,g+=(F.a=k=S[c+3])*P,x+=M,b+=I,y+=A,j+=k,F=F.next;for(L=N,q=H,i=0;i<E;i++)S[l+3]=k=g*z>>G,0!=k?(k=255/k,S[l]=($*z>>G)*k,S[l+1]=(f*z>>G)*k,S[l+2]=(s*z>>G)*k):S[l]=S[l+1]=S[l+2]=0,$-=v,f-=p,s-=m,g-=d,v-=L.r,p-=L.g,m-=L.b,d-=L.a,c=h+((c=i+e+1)<R?c:R)<<2,$+=x+=L.r=S[c],f+=b+=L.g=S[c+1],s+=y+=L.b=S[c+2],g+=j+=L.a=S[c+3],L=L.next,v+=M=q.r,p+=I=q.g,m+=A=q.b,d+=k=q.a,x-=M,b-=I,y-=A,j-=k,q=q.next,l+=4;h+=E}for(i=0;i<E;i++){for(b=y=j=x=f=s=g=$=0,v=V*(M=S[l=i<<2]),p=V*(I=S[l+1]),m=V*(A=S[l+2]),d=V*(k=S[l+3]),$+=U*M,f+=U*I,s+=U*A,g+=U*k,F=N,o=0;o<V;o++)F.r=M,F.g=I,F.b=A,F.a=k,F=F.next;for(u=E,o=1;o<=e;o++)l=u+i<<2,$+=(F.r=M=S[l])*(P=V-o),f+=(F.g=I=S[l+1])*P,s+=(F.b=A=S[l+2])*P,g+=(F.a=k=S[l+3])*P,x+=M,b+=I,y+=A,j+=k,F=F.next,o<B&&(u+=E);for(l=i,L=N,q=H,a=0;a<T;a++)S[3+(c=l<<2)]=k=g*z>>G,k>0?(k=255/k,S[c]=($*z>>G)*k,S[c+1]=(f*z>>G)*k,S[c+2]=(s*z>>G)*k):S[c]=S[c+1]=S[c+2]=0,$-=v,f-=p,s-=m,g-=d,v-=L.r,p-=L.g,m-=L.b,d-=L.a,c=i+((c=a+V)<B?c:B)*E<<2,$+=x+=L.r=S[c],f+=b+=L.g=S[c+1],s+=y+=L.b=S[c+2],g+=j+=L.a=S[c+3],L=L.next,v+=M=q.r,p+=I=q.g,m+=A=q.b,d+=k=q.a,x-=M,b-=I,y-=A,j-=k,q=q.next,l+=E}return t}(t,0,0,n):function(t,n,r,e){if(isNaN(e)||e<1)return t;e|=0;var i,a,o,c,u,l,h,$,f,s,g,v,p,m,d,x,b,y,j,M,I=t.pixels,A=t.width,k=t.height,P=e+e+1,S=A-1,E=k-1,T=e+1,D=T*(T+1)/2,R=new O,B=R;for(o=1;o<P;o++)if(B=B.next=new O,o==T)var V=B;B.next=R;var U=null,N=null;h=l=0;var F=w[e],H=C[e];for(a=0;a<k;a++){for(m=d=x=$=f=s=0,g=T*(b=I[l]),v=T*(y=I[l+1]),p=T*(j=I[l+2]),$+=D*b,f+=D*y,s+=D*j,B=R,o=0;o<T;o++)B.r=b,B.g=y,B.b=j,B=B.next;for(o=1;o<T;o++)c=l+((S<o?S:o)<<2),$+=(B.r=b=I[c])*(M=T-o),f+=(B.g=y=I[c+1])*M,s+=(B.b=j=I[c+2])*M,m+=b,d+=y,x+=j,B=B.next;for(U=R,N=V,i=0;i<A;i++)I[l]=$*F>>H,I[l+1]=f*F>>H,I[l+2]=s*F>>H,$-=g,f-=v,s-=p,g-=U.r,v-=U.g,p-=U.b,c=h+((c=i+e+1)<S?c:S)<<2,$+=m+=U.r=I[c],f+=d+=U.g=I[c+1],s+=x+=U.b=I[c+2],U=U.next,g+=b=N.r,v+=y=N.g,p+=j=N.b,m-=b,d-=y,x-=j,N=N.next,l+=4;h+=A}for(i=0;i<A;i++){for(d=x=m=f=s=$=0,g=T*(b=I[l=i<<2]),v=T*(y=I[l+1]),p=T*(j=I[l+2]),$+=D*b,f+=D*y,s+=D*j,B=R,o=0;o<T;o++)B.r=b,B.g=y,B.b=j,B=B.next;for(u=A,o=1;o<=e;o++)l=u+i<<2,$+=(B.r=b=I[l])*(M=T-o),f+=(B.g=y=I[l+1])*M,s+=(B.b=j=I[l+2])*M,m+=b,d+=y,x+=j,B=B.next,o<E&&(u+=A);for(l=i,U=R,N=V,a=0;a<k;a++)I[c=l<<2]=$*F>>H,I[c+1]=f*F>>H,I[c+2]=s*F>>H,$-=g,f-=v,s-=p,g-=U.r,v-=U.g,p-=U.b,c=i+((c=a+T)<E?c:E)*A<<2,$+=m+=U.r=I[c],f+=d+=U.g=I[c+1],s+=x+=U.b=I[c+2],U=U.next,g+=b=N.r,v+=y=N.g,p+=j=N.b,m-=b,d-=y,x-=j,N=N.next,l+=A}return t}(t,0,0,n)};function M(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:10,n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];return t=tt(t),function(r,e){e(j(r,t,n))}}function I(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:256;return gt(L([1,4,6,4,1,4,16,24,16,4,6,24,-476,24,6,4,16,24,16,4,1,4,6,4,1],-1/(t=tt(t))))}const A={blur:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3;return gt(lt(t=tt(t)))},emboss:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:4;return gt([-2*(t=tt(t)),-t,0,-t,1,t,0,t,2*t])},gaussianBlur:f,"gaussian-blur":f,gaussianBlur5x:s,"gaussian-blur-5x":s,grayscale2:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return gt(L([.3,.3,.3,0,0,.59,.59,.59,0,0,.11,.11,.11,0,0,0,0,0,0,0,0,0,0,0,0],(t=tt(t))/100))},normal:function(){return gt([0,0,0,0,1,0,0,0,0])},kirschHorizontal:g,"kirsch-horizontal":g,kirschVertical:v,"kirsch-vertical":v,laplacian:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return gt(L([-1,-1,-1,-1,8,-1,-1,-1,-1],(t=tt(t))/100))},laplacian5x:p,"laplacian-5x":p,motionBlur:m,"motion-blur":m,motionBlur2:d,"motion-blur-2":d,motionBlur3:x,"motion-blur-3":x,negative:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return gt(L([-1,0,0,0,0,0,-1,0,0,0,0,0,-1,0,0,0,0,0,1,0,1,1,1,1,1],(t=tt(t))/100))},sepia2:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return gt(L([.393,.349,.272,0,0,.769,.686,.534,0,0,.189,.168,.131,0,0,0,0,0,0,0,0,0,0,0,0],(t=tt(t))/100))},sharpen:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return gt(L([0,-1,0,-1,5,-1,0,-1,0],(t=tt(t))/100))},sobelHorizontal:b,"sobel-horizontal":b,sobelVertical:y,"sobel-vertical":y,stackBlur:M,"stack-blur":M,transparency:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;return gt(L([1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,.3,0,0,0,0,0,1],(t=tt(t))/100))},unsharpMasking:I,"unsharp-masking":I},k={kirsch:function(){return dt("kirsch-horizontal kirsch-vertical")},sobel:function(){return dt("sobel-horizontal sobel-vertical")},vintage:function(){return dt("brightness(15) saturation(-20) gamma(1.8)")}};function P(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),r.push.apply(r,e)}return r}function S(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?P(Object(r),!0).forEach((function(n){E(t,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):P(Object(r)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}function E(t,n,r){return n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}const T=S(S(S(S({},{crop:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2?arguments[2]:void 0,e=arguments.length>3?arguments[3]:void 0,i=X(r*e*4,r,e);return function(a,o){for(var c=n,u=0;c<e;c++,u++)for(var l=t,h=0;l<r;l++,h++)i.pixels[u*r*h]=a.pixels[c*r*l];o(i)}},resize:function(t,n){return function(e,i){var a=r.drawPixels(e),o=a.getContext("2d");a.width=t,a.height=n,i({pixels:new Uint8ClampedArray(o.getImageData(0,0,t,n).data),width:t,height:n})}},flipH:function(){return function(t,n){for(var r=t.width,e=t.height,i=(r%2==1?1:0)?Math.floor(r/2):r/2,a=0;a<e;a++)for(var o=0;o<i;o++){var c=a*r+o<<2,u=a*r+(r-1-o)<<2;ct(t.pixels,c,u)}n(t)}},flipV:function(){return function(t,n){for(var r=t.width,e=t.height,i=(e%2==1?1:0)?Math.floor(e/2):e/2,a=0;a<i;a++)for(var o=0;o<r;o++){var c=a*r+o<<2,u=(e-1-a)*r+o<<2;ct(t.pixels,c,u)}n(t)}},rotate:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return t=tt(t),t%=360,function(n,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(0==t)return n;if(90==t||270==t)var i=X(n.pixels.length,n.height,n.width);else{if(180!=t)return l(t)(n,r,e);i=X(n.pixels.length,n.width,n.height)}ut((function(r,e,a,o){if(90==t)var c=a*i.width+(i.width-1-o)<<2;else 270==t?c=(i.height-1-a)*i.width+o<<2:180==t&&(c=(i.height-1-o)*i.width+(i.width-1-a)<<2);$t(i.pixels,c,n.pixels,e)}))(n,(function(){r(i)}),e)}},rotateDegree:l,histogram:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"gray",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],r=[],e=0;e<n.length-1;e++)for(var i=n[e],a=n[e+1],o=a[0]-i[0],c=a[1]-i[1],u=c/o,l=0,h=i[0];l<o;l++,h++)r[h]=i[1]+l*u;return r[255]=255,at("red"===t?function(){$r=r[$r]}:"green"===t?function(){$g=r[$g]}:"blue"===t?function(){$b=r[$b]}:function(){var t=Color.RGBtoYCrCb($r,$g,$b),n=Color.YCrCbtoRGB(clamp(r[clamp(t.y)]),t.cr,t.cb,0);$r=n.r,$g=n.g,$b=n.b},{},{$realPoints:r})},"rotate-degree":l}),$),A),k);var D;function R(t){return function(t){if(Array.isArray(t))return B(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return B(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?B(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function B(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,e=new Array(n);r<n;r++)e[r]=t[r];return e}function V(t,n,r){return n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}var U=0,N=(V(D={partial:wt,multi:bt,merge:yt,weight:L,repeat:q,colorMatrix:function(t,n,r){var e=t[n],i=t[n+1],a=t[n+2],o=t[n+3];ht(t,n,r[0]*e+r[1]*i+r[2]*a+r[3]*o,r[4]*e+r[5]*i+r[6]*a+r[7]*o,r[8]*e+r[9]*i+r[10]*a+r[11]*o,r[12]*e+r[13]*i+r[14]*a+r[15]*o)},each:Y,eachXY:W,createRandomCount:function(){return[9,16,25,36,49,64,81,100].sort((function(t,n){return.5-Math.random()}))[0]},createRandRange:function(t,n,r){for(var e=[],i=1;i<=r;i++){var a=Math.random()*(n-t)+t,o=Math.floor(10*Math.random())%2==0?-1:1;e.push(o*a)}e.sort();var c=Math.floor(r>>1),u=e[c];return e[c]=e[0],e[0]=u,e},createBitmap:X,createBlurMatrix:lt,pack:function(t){return function(n,r){Y(n.pixels.length,(function(r,e){t(n.pixels,r,e,n.pixels[r],n.pixels[r+1],n.pixels[r+2],n.pixels[r+3])}),(function(){r(n)}))}},packXY:ut,pixel:at,getBitmap:Q,putBitmap:Z,radian:function(t){return o.CONSTANT.radian(t)},convolution:gt,parseParamNumber:tt,filter:dt,clamp:mt,fillColor:ht,fillPixelColor:$t},"multi",bt),V(D,"merge",yt),V(D,"matches",vt),V(D,"parseFilter",pt),V(D,"partial",wt),D),F=N;const H=N;function L(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return t.map((function(t){return t*n}))}function q(t,n){for(var r=new Array(n),e=0;e<n;e++)r[e]=t;return r}function z(t){if("function"==typeof t)return t;"string"==typeof t&&(t=[t]);var n=(t=t.slice(0)).shift();if("function"==typeof n)return n;var r=t,e=T[n]||F[n];if(!e)throw new Error("".concat(n," is not filter. please check filter name."));return e.apply(e,r)}function G(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,e=arguments.length>3?arguments[3]:void 0,i=arguments.length>4?arguments[4]:void 0,a=arguments.length>5&&void 0!==arguments[5]?arguments[5]:1e4,o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:"full",c=arguments.length>7&&void 0!==arguments[7]?arguments[7]:50,u=n,l=function(t){setTimeout(t,0)};function h(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:50,n=R(Array(t)),r=n.map((function(t){return"cri = ri + i * s; if (cri >= mx) return {currentRunIndex: cri, i: null}; c(cri); i++;"})).join("\n"),e=new Function("ri","i","s","mx","c","\n            let cri = ri;\n            \n            ".concat(r,"\n            \n            return {currentRunIndex: cri, i: i} \n        "));return e}function $(){for(var n=h(c),i=u,o={},l=0;l<a;){if(null==(o=n(u,l,r,t,e)).i){i=o.currentRunIndex;break}l=o.i,i=o.currentRunIndex}f(i)}function f(n){n?u=n:u+=r,u>=t?i():l?l($):$()}"requestAnimationFrame"==o&&(l=requestAnimationFrame,a=1e3),"full"==o&&(l=null,a=t),$()}function Y(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};G(t,0,4,(function(t){n(t,t>>2)}),(function(){r()}),e.functionDumpCount,e.frameTimer,e.loopCount)}function W(t,n,r,e){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};G(t,0,4,(function(t){var e=t>>2;r(t,e%n,Math.floor(e/n))}),(function(){e()}),i.functionDumpCount,i.frameTimer,i.loopCount)}function X(t,n,r){return{pixels:new Uint8ClampedArray(t),width:n,height:r}}function _(t,n,r,e){for(var i=n.pixels.length/4,a=0,o=0,c=0,u=0,l=0,h=0,$=0;$<i;$++)c=$%n.width,o=e+(u=Math.floor($/n.width)),(a=r+c)>t.width||o>t.height||(l=u*n.width+c<<2,h=o*t.width+a<<2,t.pixels[h]=n.pixels[l],t.pixels[h+1]=n.pixels[l+1],t.pixels[h+2]=n.pixels[l+2],t.pixels[h+3]=n.pixels[l+3])}function J(t,n,r,e){for(var i=n.pixels.length>>2,a=0,o=0,c=0,u=0,l=0,h=0,$=0;$<i;$++)c=$%n.width,o=e+(u=Math.floor($/n.width)),(a=r+c)>t.width||o>t.height||(l=o*t.width+a<<2,h=u*n.width+c<<2,n.pixels[h]=t.pixels[l],n.pixels[h+1]=t.pixels[l+1],n.pixels[h+2]=t.pixels[l+2],n.pixels[h+3]=t.pixels[l+3])}function K(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=t.width+n,e=t.height+n,i={pixels:new Uint8ClampedArray(r*e*4),width:r,height:e};return i}function Q(t,n){return r.getBitmap(t,n)}function Z(t,n,e){return r.putBitmap(t,n,e)}function tt(t){return"string"==typeof t&&(t=(t=t.replace(/deg/,"")).replace(/px/,"")),+t}var nt=/(([\w_\-]+)(\(([^\)]*)\))?)+/gi;function rt(t){var r=t.map((function(t){return" \n            ".concat(t.userFunction.$preContext,"\n\n            ").concat(t.userFunction.$preCallbackString,"\n\n            $r = clamp($r); $g = clamp($g); $b = clamp($b); $a = clamp($a);\n        ")})).join("\n\n"),e={clamp:mt,Color:n()};t.forEach((function(t){Object.assign(e,t.userFunction.rootContextObject)}));var i="const "+Object.keys(e).map((function(t){return" ".concat(t," = $rc.").concat(t," ")})).join(","),a=" \n    let $r = $p[$pi], $g = $p[$pi+1], $b = $p[$pi+2], $a = $p[$pi+3];\n    \n    ".concat(i,"\n\n    ").concat(r,"\n    \n    $p[$pi] = $r; $p[$pi+1] = $g; $p[$pi+2] = $b; $p[$pi+3] = $a;\n    "),o=new Function("$p","$pi","$rc",a);return function(t,n){o(t,n,e)}}function et(t){var n={},r=t.map((function(t){var r=[];Object.keys(t.context).forEach((function(t,n){r[t]="n$".concat(U++).concat(t,"$")})),Object.keys(t.rootContext).forEach((function(e,i){r[e]="r$".concat(U++).concat(e,"$"),n[r[e]]=t.rootContext[e]}));var e=Object.keys(t.context).filter((function(n){return"number"!=typeof t.context[n]&&"string"!=typeof t.context[n]&&(!Array.isArray(t.context[n])||"number"!=typeof t.context[n][0]&&"string"!=typeof t.context[n][0])})).map((function(n,e){return[r[n],JSON.stringify(t.context[n])].join(" = ")})),i=t.callback;return"function"==typeof t.callback&&((i=t.callback.toString().split("{")).shift(),(i=(i=i.join("{")).split("}")).pop(),i=i.join("}")),Object.keys(r).forEach((function(n){var e=r[n];"number"==typeof t.context[n]||"string"==typeof t.context[n]?i=i.replace(new RegExp("\\"+n,"g"),t.context[n]):!Array.isArray(t.context[n])||"number"!=typeof t.context[n][0]&&"string"!=typeof t.context[n][0]?i=i.replace(new RegExp("\\"+n,"g"),e):t.context[n].forEach((function(t,r){i=i.replace(new RegExp("\\"+n+"\\["+r+"\\]","g"),t)}))})),{preCallbackString:i,preContext:e}})),e=r.map((function(t,n){return t.preContext.length?"const ".concat(t.preContext,";"):""})).join("\n\n"),i=r.map((function(t){return t.preCallbackString})).join("\n\n"),a=" \n    let $r = $pixels[$pixelIndex], $g = $pixels[$pixelIndex+1], $b = $pixels[$pixelIndex+2], $a = $pixels[$pixelIndex+3];\n\n    ".concat(e,"\n\n    ").concat(i,"\n    \n    $pixels[$pixelIndex] = $r\n    $pixels[$pixelIndex+1] = $g \n    $pixels[$pixelIndex+2] = $b   \n    $pixels[$pixelIndex+3] = $a   \n    "),o=new Function("$pixels","$pixelIndex","$clamp","$Color",a);return o.$preCallbackString=i,o.$preContext=e,o.rootContextObject=n,o}function it(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};return et([{callback:t,context:n,rootContext:r}])}function at(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e=it(t,n,r),i=function(t,n){};return i.userFunction=e,i}var ot=[0,1,2,3];function ct(t,n,r){ot.forEach((function(e){var i=t[n+e];t[n+e]=t[r+e],t[r+e]=i}))}function ut(t){return function(n,r){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};W(n.pixels.length,n.width,(function(r,e,i){t(n.pixels,r,e,i)}),(function(){r(n)}),e)}}function lt(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:3,n=Math.pow(t,2),r=1/n;return q(r,n)}function ht(t,n,r,e,i,a){if(3==arguments.length){var o=arguments[2];r=o.r,e=o.g,i=o.b,a=o.a}"number"==typeof r&&(t[n]=r),"number"==typeof e&&(t[n+1]=e),"number"==typeof i&&(t[n+2]=i),"number"==typeof a&&(t[n+3]=a)}function $t(t,n,r,e){ht(t,n,r[e],r[e+1],r[e+2],r[e+3])}function ft(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:255,e=[];return e=t.map((function(t,n){return[]})),t.forEach((function(t,i){if(0!=t){var a=e[i];for(i=n;i<=r;i++)a[i]=t*i}})),e}function st(t,n,r,e,i){var a=Math.round(Math.sqrt(t.length)),o=Math.floor(a/2),c=i?1:0,u="let r = 0, g = 0, b = 0, a = 0, scy = 0, scx =0, si = 0; ",l=[],h=[],$=[],f=[];t.forEach((function(t,n){var e=Math.floor(n/a)-o,i=n%a-o;0!=t&&(l.push("$t[".concat(n,"][$sp[(($sy + (").concat(e,")) * ").concat(r," + ($sx + (").concat(i,"))) * 4]]")),h.push("$t[".concat(n,"][$sp[(($sy + (").concat(e,")) * ").concat(r," + ($sx + (").concat(i,"))) * 4 + 1]]")),$.push("$t[".concat(n,"][$sp[(($sy + (").concat(e,")) * ").concat(r," + ($sx + (").concat(i,"))) * 4 + 2]]")),f.push("$t[".concat(n,"][$sp[(($sy + (").concat(e,")) * ").concat(r," + ($sx + (").concat(i,"))) * 4 + 3]]")))})),u+="r = ".concat(l.join(" + "),"; g = ").concat(h.join(" + "),"; b = ").concat($.join(" + "),"; a = ").concat(f.join(" + "),";"),u+="$dp[$di] = r; $dp[$di+1] = g;$dp[$di+2] = b;$dp[$di+3] = a + (".concat(c,")*(255-a); ");var s=new Function("$dp","$sp","$di","$sx","$sy","$t",u);return function(t,r,e,i,a){s(t,r,e,i,a,n)}}function gt(t){var n=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=ft(t);return function(e,i){var a=Math.round(Math.sqrt(t.length)),o=K(e,2*a);_(o,e,a,a);for(var c=X(o.pixels.length,o.width,o.height),u=X(e.pixels.length,e.width,e.height),l=st(t,r,o.width,o.height,n),h=e.pixels.length/4,$=0;$<h;$++){var f=$,s=f%e.width+a,g=Math.floor(f/e.width)+a;l(c.pixels,o.pixels,4*(g*o.width+s),s,g)}J(c,u,a,a),i(u)}}function vt(t){var r=n().convertMatches(t),e=r.str.match(nt),i=[];if(!e)return i;i=e.map((function(t){return{filter:t,origin:EasyLogicColor.reverseMatches(t,r.matches)}}));var a={next:0};return i.map((function(n){var r=t.indexOf(n.origin,a.next);return n.startIndex=r,n.endIndex=r+n.origin.length,n.arr=pt(n.origin),a.next=n.endIndex,n})).filter((function(t){return!!t.arr.length}))}function pt(t){var n=EasyLogicColor.convertMatches(t),r=n.str.match(nt);if(!r[0])return[];var e=r[0].split("("),i=e.shift(),a=[];return e.length&&(a=e.shift().split(")")[0].split(",").map((function(t){return EasyLogicColor.reverseMatches(t,n.matches)}))),[i].concat(R(a)).map(EasyLogicColor.trim)}function mt(t){return Math.min(255,t)}function dt(t){return yt(vt(t).map((function(t){return t.arr})))}function xt(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],n=[],r=[],e=0,i=t.length;e<i;e++){var a=t[e];a.userFunction?r.push(a):(r.length&&n.push(R(r)),n.push(a),r=[])}return r.length&&n.push(R(r)),n.forEach((function(t,r){var e;Array.isArray(t)&&(n[r]=(e=rt(t),function(t,n){for(var r=0,i=t.pixels.length;r<i;r+=4)e(t.pixels,r);n(t)}))})),n}function bt(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];var e=(n=xt(n=n.map((function(t){return z(t)})).filter((function(t){return t})))).length;return function(t,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=t,o=0;function c(){n[o].call(null,a,(function(t){a=t,u()}),i)}function u(){++o>=e?r(a):c()}c()}}function yt(t){return bt.apply(void 0,R(t))}function wt(t){for(var n=null,r=arguments.length,e=new Array(r>1?r-1:0),i=1;i<r;i++)e[i-1]=arguments[i];return n=1==e.length&&"string"==typeof e[0]?dt(e[0]):yt(e),function(r,e){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};n(Q(r,t),(function(n){e(Z(r,n,t))}),i)}}function Ct(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),r.push.apply(r,e)}return r}function Ot(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Ct(Object(r),!0).forEach((function(n){jt(t,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Ct(Object(r)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}function jt(t,n,r){return n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}const Mt=Ot(Ot({},T),H);function It(t,n){if(!(t instanceof n))throw new TypeError("Cannot call a class as a function")}function At(t,n){for(var r=0;r<n.length;r++){var e=n[r];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(t,e.key,e)}}const kt=function(){function t(n){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};It(this,t),this.isLoaded=!1,this.imageUrl=n,this.opt=r,this.initialize()}var n,e;return n=t,(e=[{key:"initialize",value:function(){this.canvas=this.createCanvas(),this.context=this.canvas.getContext("2d")}},{key:"createCanvas",value:function(){return document.createElement("canvas")}},{key:"load",value:function(t){var n=this;this.newImage=new Image;var r=this.newImage;r.onload=function(){n.isLoaded=!0,t&&t()},this.getImageUrl((function(t){r.src=t}))}},{key:"loadImage",value:function(t){var n=this,r=this.context;this.newImage=new Image;var e=this.newImage;e.onload=function(){var i=e.height/e.width;n.opt.canvasWidth&&n.opt.canvasHeight?(n.canvas.width=n.opt.canvasWidth,n.canvas.height=n.opt.canvasHeight):(n.canvas.width=n.opt.maxWidth?n.opt.maxWidth:e.width,n.canvas.height=n.canvas.width*i),r.drawImage(e,0,0,e.width,e.height,0,0,n.canvas.width,n.canvas.height),n.isLoaded=!0,t&&t()},this.getImageUrl((function(t){e.src=t}))}},{key:"getImageUrl",value:function(t){if("string"==typeof this.imageUrl)return t(this.imageUrl);if(this.imageUrl instanceof Blob){var n=new FileReader;n.onload=function(n){t(n.target.result)},n.readAsDataURL(this.imageUrl)}}},{key:"getRGBA",value:function(t,n,r,e){return[t,n,r,e]}},{key:"toArray",value:function(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),a=i.width,o=i.height,c=new Uint8ClampedArray(i.data),u={pixels:c,width:a,height:o};t||(t=function(t,n){n(t)}),t(u,(function(t){var i=r.drawPixels(t);"canvas"==e.returnTo?n(i):n(i.toDataURL(e.outputFormat||"image/png"))}),e)}},{key:"toHistogram",value:function(t){var n=this.context.getImageData(0,0,this.canvas.width,this.canvas.height),e=n.width,i=n.height,a={pixels:new Uint8ClampedArray(n.data),width:e,height:i};return r.getHistogram(a)}},{key:"toRGB",value:function(){for(var t=this.context.getImageData(0,0,this.canvas.width,this.canvas.height).data,n=[],r=0,e=t.length;r<e;r+=4)n[n.length]=[t[r+0],t[r+1],t[r+2],t[r+3]];return n}}])&&At(n.prototype,e),t}();function Pt(t,n){if(t.length!==n.length)return!1;for(var r=0,e=t.length;r<e;++r)if(t[r]!==n[r])return!1;return!0}var St={euclidean:function(t,n){for(var r=0,e=0,i=t.length;e<i;e++)r+=Math.pow(n[e]-t[e],2);return Math.sqrt(r)},manhattan:function(t,n){for(var r=0,e=0,i=t.length;e<i;e++)r+=Math.abs(n[e]-t[e]);return r},max:function(t,n){for(var r=0,e=0,i=t.length;e<i;e++)r=Math.max(r,Math.abs(n[e]-t[e]));return r}},Et={linear:function(t,n){var r=[],e=Math.round(Math.random()*t),i=Math.floor(t/n);do{r.push(e),e=(e+i)%t}while(r.length<n);return r},shuffle:function(t,n){for(var r=[];r.length<n;){var e=Math.round(Math.random()*t);-1==r.indexOf(e)&&r.push(e)}return r}};function Tt(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"linear",e=Et[r](t.length,n);return e.map((function(n){return t[n]}))}function Dt(t,n,r){var e=1/0,i=0;return n.forEach((function(n,a){var o=r(t,n);o<e&&(e=o,i=a)})),i}function Rt(t){if(!t.length)return[];for(var n=new Array(t[0].length),r=0,e=n.length;r<e;r++)n[r]=0;var i=0;for(e=t.length;i<e;i++)for(var a=t[i],o=i+1,c=0,u=a.length;c<u;c++)n[c]+=(a[c]-n[c])/o;return n.map((function(t){return Math.floor(t)}))}function Bt(t,n,r,e){for(var i=new Array(t),a=0;a<t;a++)i[a]=[];for(var o=0,c=n.length;o<c;o++){var u=n[o];i[Dt(u,r,e)].push(u)}return i}function Vt(t,n,r,e,i,a){for(var o=0;o<t;o++){var c=r[o],u=e[o],l=new Array(u.length);i=!Pt(l=c.length>0?Rt(c):n[Math.floor(a()*n.length)],u),e[o]=l}return i}const Ut=function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:10,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:"linear";t=t,n=n||Math.max(2,Math.ceil(Math.sqrt(t.length/2)));var a=r||"euclidean";"string"==typeof a&&(a=St[a]);for(var o=0,c=function(){return(o=(9301*o+49297)%233280)/233280},u=Tt(t,n,i),l=!0,h=0;l;){var $=Bt(n,t,u,a);if(l=Vt(n,t,$,u,!1,c),++h%e==0)break}return u};function Nt(t){return function(t){if(Array.isArray(t))return Ft(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,n){if(t){if("string"==typeof t)return Ft(t,n);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?Ft(t,n):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function Ft(t,n){(null==n||n>t.length)&&(n=t.length);for(var r=0,e=new Array(n);r<n;r++)e[r]=t[r];return e}function Ht(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{frameTimer:"full"},i=new kt(t);i.loadImage((function(){i.toArray(n,(function(t){"function"==typeof r&&r(t)}),e)}))}function Lt(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),r.push.apply(r,e)}return r}function qt(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Lt(Object(r),!0).forEach((function(n){zt(t,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Lt(Object(r)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}function zt(t,n,r){return n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}function Gt(t,n){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(t);n&&(e=e.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),r.push.apply(r,e)}return r}function Yt(t,n,r){return n in t?Object.defineProperty(t,n,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[n]=r,t}const Wt=function(t){for(var n=1;n<arguments.length;n++){var r=null!=arguments[n]?arguments[n]:{};n%2?Gt(Object(r),!0).forEach((function(n){Yt(t,n,r[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):Gt(Object(r)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))}))}return t}({},qt(qt({},{palette:function(t){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6,e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"hex";return t.length>r&&(t=Ut(t,r)),t.map((function(t){return n().format(t,e)}))},ImageToCanvas:function(t,n,r){var e=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{frameTimer:"full"};Ht(t,n,r,Object.assign({returnTo:"canvas"},e))},ImageToHistogram:function(t,n){var e=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{width:200,height:100},i=new kt(t);i.loadImage((function(){r.createHistogram(e.width||200,e.height||100,i.toHistogram(e),(function(t){"function"==typeof n&&n(t.toDataURL("image/png"))}),e)}))},ImageToRGB:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=arguments.length>2?arguments[2]:void 0;if(r){if(r){var e;(e=new kt(t,n)).loadImage((function(){"function"==typeof r&&r(e.toRGB())}))}}else(e=new kt(t)).loadImage((function(){"function"==typeof n&&n(e.toRGB())}))},ImageToURL:Ht,histogram:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},e=new kt(t);e.loadImage((function(){"function"==typeof n&&n(e.toHistogram(r))}))},histogramToPoints:function(t){for(var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:.2,r=[],e=0;e<t.length;e++){var i=t[e];if(0!=e)if(e!=t.length-1){var a=t[e-1],o=t[e+1],c=(o[1],a[1],o[0],a[0],[a[0]+(o[0]-a[0])*n,a[1]+(o[1]-a[1])*n]),u=[Nt(a),[].concat(c)],l=Math.sqrt(Math.pow(i[0]-a[0],2)+Math.pow(i[1]-a[1],2)),h=Math.sqrt(Math.pow(o[0]-i[0],2)+Math.pow(o[1]-i[1],2)),$=l/h,f=u[0][0]+(u[1][0]-u[0][0])*$,s=u[0][1]+(u[1][1]-u[0][1])*$;u[0][0]+=i[0]-f,u[0][1]+=i[1]-s,u[1][0]+=i[0]-f,u[1][1]+=i[1]-s,r[e]=u}else r[e]=[];else r[e]=[]}return r}}),{},{ImageFilter:Mt,Canvas:r,ImageLoader:kt}))})(),i.default})()}));